# Mushroom Card Configuration for Waste Collection Dashboard
# Copy this into your Home Assistant dashboard (Lovelace UI)

type: vertical-stack
cards:
  # Title Card
  - type: custom:mushroom-title-card
    title: Waste Collection
    subtitle: Ryde Council - Next Collections

  # General Waste Card
  - type: custom:mushroom-template-card
    primary: General Waste
    secondary: >-
      {% if states('sensor.ryde_waste_general') != 'unknown' %}
        {{ states('sensor.ryde_waste_general') }}
        {% if state_attr('sensor.ryde_waste_general', 'days_until') is not none %}
          ({{ state_attr('sensor.ryde_waste_general', 'days_until') }} days)
        {% endif %}
      {% else %}
        No data available
      {% endif %}
    icon: mdi:trash-can
    icon_color: >-
      {% if state_attr('sensor.ryde_waste_general', 'upcoming') == true %}
        red
      {% else %}
        grey
      {% endif %}
    badge_icon: >-
      {% if state_attr('sensor.ryde_waste_general', 'upcoming') == true %}
        mdi:bell-ring
      {% endif %}
    badge_color: red
    tap_action:
      action: more-info
    entity: sensor.ryde_waste_general

  # Recycling Card
  - type: custom:mushroom-template-card
    primary: Recycling
    secondary: >-
      {% if states('sensor.ryde_waste_recycling') != 'unknown' %}
        {{ states('sensor.ryde_waste_recycling') }}
        {% if state_attr('sensor.ryde_waste_recycling', 'days_until') is not none %}
          ({{ state_attr('sensor.ryde_waste_recycling', 'days_until') }} days)
        {% endif %}
      {% else %}
        No data available
      {% endif %}
    icon: mdi:recycle
    icon_color: >-
      {% if state_attr('sensor.ryde_waste_recycling', 'upcoming') == true %}
        yellow
      {% else %}
        grey
      {% endif %}
    badge_icon: >-
      {% if state_attr('sensor.ryde_waste_recycling', 'upcoming') == true %}
        mdi:bell-ring
      {% endif %}
    badge_color: yellow
    tap_action:
      action: more-info
    entity: sensor.ryde_waste_recycling

  # Garden Organics Card
  - type: custom:mushroom-template-card
    primary: Garden Organics
    secondary: >-
      {% if states('sensor.ryde_waste_garden') != 'unknown' %}
        {{ states('sensor.ryde_waste_garden') }}
        {% if state_attr('sensor.ryde_waste_garden', 'days_until') is not none %}
          ({{ state_attr('sensor.ryde_waste_garden', 'days_until') }} days)
        {% endif %}
      {% else %}
        No data available
      {% endif %}
    icon: mdi:leaf
    icon_color: >-
      {% if state_attr('sensor.ryde_waste_garden', 'upcoming') == true %}
        green
      {% else %}
        grey
      {% endif %}
    badge_icon: >-
      {% if state_attr('sensor.ryde_waste_garden', 'upcoming') == true %}
        mdi:bell-ring
      {% endif %}
    badge_color: green
    tap_action:
      action: more-info
    entity: sensor.ryde_waste_garden

  # Next Collection Summary Card
  - type: custom:mushroom-chips-card
    chips:
      - type: template
        icon: mdi:calendar-check
        content: >-
          {% set upcoming = namespace(found=false, min_days=999, type='') %}
          {% for sensor in ['sensor.ryde_waste_general', 'sensor.ryde_waste_recycling', 'sensor.ryde_waste_garden'] %}
            {% if state_attr(sensor, 'days_until') is not none and state_attr(sensor, 'days_until') >= 0 %}
              {% if state_attr(sensor, 'days_until') < upcoming.min_days %}
                {% set upcoming.min_days = state_attr(sensor, 'days_until') %}
                {% set upcoming.type = state_attr(sensor, 'collection_type') %}
                {% set upcoming.found = true %}
              {% endif %}
            {% endif %}
          {% endfor %}
          {% if upcoming.found %}
            Next: {{ upcoming.type }} in {{ upcoming.min_days }} day{{ 's' if upcoming.min_days != 1 else '' }}
          {% else %}
            No upcoming collections
          {% endif %}
        icon_color: blue
